{% extends 'generic.html' %}
{% load static %}

{% block generic__content %}
    <form id="card__form" method="post" action="{% block card__action %}{% endblock %}">
        <h1>{% block card__capture %}{% endblock %} <span id="card__capture">_</span></h1>

        {% csrf_token %}
        {{ form.non_field_errors }}

        {% block card__before_username %}{% endblock %}

        <div class="field">
            {{ form.username.label_tag }}
            {{ form.username }}
            {{ form.username.errors }}
        </div>

        <div class="field">
            {{ form.password.label_tag }}
            <div class="group-field">
                {{ form.password }}
                <div id="card__copypass" class="input-icon icon-animate icon-right no-select">
                    <img src="{% static 'pudding/img/copy.svg' %}" alt="copy password">
                </div>
            </div>
             {{ form.password.errors }}
            <div class="help-text">
                <input type="checkbox" id="card__showpass">
                <label for="card__showpass">Show password</label>
            </div>
        </div>

        <div class="field">
            {{ form.notes.label_tag }}
            {{ form.notes }}
            {{ form.notes.errors }}
        </div>

        <div class="field">
            {{ form.is_favorite }}
            {{ form.is_favorite.label_tag }}
            {{ form.is_favorite.errors }}
        </div>

        {% block card__after_favorite %}{% endblock %}

        {% block card__submit %}{% endblock %}
    </form>

    {% block card__delete %}{% endblock %}

    <script>
        const capture = document.getElementById('card__capture');
        const password = document.getElementById('id_password');


        document.getElementById('card__copypass').addEventListener('click', function(event) {
            var buffer = document.createElement('textarea');

            buffer.setAttribute('readonly', '');
            buffer.style.position = 'absolute';
            buffer.style.left = '-9999px';
            buffer.value = password.value;
            document.body.appendChild(buffer);

            buffer.select();
            document.execCommand('copy');

            buffer.remove();
        });

        document.getElementById('card__showpass').addEventListener('click', function(event) {
            if (event.target.checked) { password.type = 'text'; }
            else { password.type = 'password'; }
        });
    </script>
    {% block card__js %}{% endblock %}
{% endblock %}
